import{ez as h,cL as P,cM as C,c_ as T,aX as j,ej as p,ek as v,cO as D,cW as X,eh as E}from"./index-DoYlmobM.js";import{r as k,c as i,a as L}from"./vectorStacks-CPr9auFt.js";function Z(r){const u=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],I=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],n=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(u,I,n))}function B(r,u){const I=Math.sqrt(u[0]*u[0]+u[4]*u[4]+u[8]*u[8]),n=Math.sqrt(u[1]*u[1]+u[5]*u[5]+u[9]*u[9]),e=Math.sqrt(u[2]*u[2]+u[6]*u[6]+u[10]*u[10]);return h(r,I,n,e),r}function z(r,u,I){Math.abs(r[0])>Math.abs(r[1])?h(u,0,1,0):h(u,1,0,0),P(I,r,u),P(u,I,r),C(I,I),C(u,u)}function x(r=_){return[r[0],r[1],r[2],r[3]]}function rr(r=_[0],u=_[1],I=_[2],n=_[3]){return d(r,u,I,n,k.get())}function H(r,u){return d(u[0],u[1],u[2],u[3],r)}function ur(r){return r}function d(r,u,I,n,e=x()){return e[0]=r,e[1]=u,e[2]=I,e[3]=n,e}function W(r,u,I){const n=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],e=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return I[0]=u[0]*e,I[1]=u[1]*e,I[2]=u[2]*e,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function w(r,u,I,n=x()){const e=I[0]-u[0],o=I[1]-u[1],c=I[2]-u[2],t=r[0]-u[0],O=r[1]-u[1],g=r[2]-u[2],M=o*g-c*O,R=c*t-e*g,q=e*O-o*t,b=M*M+R*R+q*q,m=Math.abs(b-1)>1e-5&&b>1e-12?1/Math.sqrt(b):1;return n[0]=M*m,n[1]=R*m,n[2]=q*m,n[3]=-(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),n}function y(r,u,I,n=0,e=Math.floor(I*(1/3)),o=Math.floor(I*(2/3))){if(I<3)return!1;u(S,n);let c=e,t=!1;for(;c<I-1&&!t;)u(f,c),c++,t=!X(S,f);if(!t)return!1;for(c=Math.max(c,o),t=!1;c<I&&!t;)u(s,c),c++,E(U,S,f),C(U,U),E(l,f,s),C(l,l),t=!X(S,s)&&!X(f,s)&&Math.abs(T(U,l))<G;return t?(w(S,f,s,r),!0):(n!==0||e!==1||o!==2)&&y(r,u,I,0,1,2)}function Ir(r,u,I=!0){const n=u.length/3;return y(r,((e,o)=>h(e,u[3*o+0],u[3*o+1],u[3*o+2])),I?n-1:n)}const G=.99619469809,S=D(),f=D(),s=D(),U=D(),l=D();function nr(r,u,I){return u!==r&&H(r,u),r[3]=-T(r,I),r}function er(r,u){return u[0]=-r[0],u[1]=-r[1],u[2]=-r[2],u[3]=-r[3],u}function tr(r,u,I,n){return P(s,u,r),W(I,s,n)}function cr(r,u,I,n){return F($(r,u,E(i.get(),I,u),K,n))}function or(r,u,I){return u!=null&&F($(r,u.origin,u.direction,Q,I))}function Nr(r,u,I){return F($(r,u.origin,u.vector,a.NONE,I))}function ar(r,u,I){return F($(r,u.origin,u.vector,a.CLAMP,I))}function ir(r,u){return A(r,u)>=0}function sr(r,u){const I=T(r,u.ray.direction),n=-A(r,u.ray.origin);if(I>-1e-6&&I<1e-6)return n>0;const e=n/I;return I>0?e<u.c1&&(u.c1=e):e>u.c0&&(u.c0=e),u.c0<=u.c1}function fr(r,u,I){const n=v(i.get(),r,-r[3]),e=J(r,E(i.get(),u,n),i.get());return p(I,e,n),I}function Er(r,u,I,n){const e=r,o=i.get(),c=i.get();z(e,o,c);const t=E(i.get(),I,u),O=L(o,t),g=L(c,t),M=L(e,t);return h(n,O,g,M)}function J(r,u,I){const n=v(i.get(),r,T(r,u));return E(I,u,n),I}function Tr(r,u){return Math.abs(A(r,u))}function A(r,u){return T(r,u)+r[3]}var N;function F(r){return r===N.INTERSECTS_INSIDE_OUT||r===N.INTERSECTS_OUTSIDE_IN}function $(r,u,I,n,e){const o=T(r,I),c=A(r,u);if(o===0)return c>=0?N.INSIDE:N.OUTSIDE;let t=-c/o;return n&a.CLAMP&&(t=j(t,0,1)),!(n&a.INFINITE_MIN)&&t<0||!(n&a.INFINITE_MAX)&&t>1?c>=0?N.INSIDE:N.OUTSIDE:(p(e,u,v(e,I,t)),c>=0?N.INTERSECTS_INSIDE_OUT:N.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(N||(N={}));const _=[0,0,1,0];var a;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(a||(a={}));const K=a.INFINITE_MIN|a.INFINITE_MAX,Q=a.INFINITE_MAX;export{Ir as A,rr as D,sr as G,fr as H,Er as J,er as L,x as M,ur as O,tr as P,Tr as Q,d as U,A as V,z as a,B as g,H as h,cr as k,W as l,Z as m,w as p,or as q,y as v,ar as w,Nr as x,nr as y,ir as z};
